{"version":3,"sources":["pivot_spec.coffee"],"names":["fixtureData","fixtureData2","describe","table","beforeEach","done","$","pivotUI","dataClass","pivotUtilities","SubtotalPivotData","renderers","subtotal_renderers","onRefresh","it","expect","find","length","toBe","val","text","join","data","rows","cols","aggregators","subtotal_aggregators","vals","rendererOptions","collapseColsAt","collapseRowsAt","rowSubtotalDisplay","hideOnExpand","colSubtotalDisplay","displayOnTop","attr","pivot","renderer","aggregator","sumOverSumOpts","filter","sorters","aoaInput","pd","getAggregator","value","aosInput","a","b","functionInput","record","tableInput","getRowKeys","toEqual","getColKeys","c","i","j","len","len1","numNotNull","numNull","r","ref","ref1","agg","results","s","spots","spot","format","hdr"],"mappings":"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","file":"pivot_spec.min.js","sourcesContent":["fixtureData = [\n    [\"name\",    \"gender\",   \"colour\",       \"birthday\",     \"trials\",   \"successes\"],\n    [\"Nick\",    \"male\",     \"blue\",         \"1982-11-07\",   103,        12],\n    [\"Jane\",    \"female\",   \"red\",          \"1982-11-08\",   95,         25],\n    [\"John\",    \"male\",     \"blue\",         \"1982-12-08\",   112,        30],\n    [\"Carol\",   \"female\",   \"yellow\",       \"1983-11-11\",   102,        14],\n    [\"Raj\",     \"male\",     \"blue\",         \"1982-11-07\",   103,        12],\n    [\"Rani\",    \"female\",   \"red\",          \"1982-11-08\",   95,         25],\n    [\"Joshi\",   \"male\",     \"blue\",         \"1982-12-09\",   112,        12],\n    [\"Vel\",     \"male\",     \"yellow\",       \"1982-12-01\",   112,        25],\n    [\"Sai\",     \"male\",     \"red\",          \"1982-11-08\",   112,        30],\n    [\"Geeth\",   \"female\",   \"blue\",         \"1982-12-03\",   112,        14],\n    [\"Malar\",   \"male\",     \"red\",          \"1982-11-05\",   112,        12],\n    [\"Nila\",    \"male\",     \"blue\",         \"1982-12-07\",   112,        25],\n    [\"Yaazhi\",  \"male\",     \"yellow\",       \"1982-12-06\",   112,        30],\n    [\"Mukhi\",   \"male\",     \"yellow\",       \"1982-11-07\",   112,        14]]\n\nfixtureData2 = [\n    [\"name\",    \"gender\",   \"colour\",    \"birthday\",     \"trials\",   \"successes\"],\n    [\"Nick\",    \"male\",     \"blue\",      \"1982-11-07\",   103,        12],\n    [\"Jane\",    \"female\",   \"red\",       \"1982-11-08\",   95,         25],\n    [\"John\",    \"male\",     \"blue\",      \"1982-12-08\",   112,        30],\n    [\"Carol\",   \"female\",   \"yellow\",    \"1983-12-08\",   102,        14]]\n\n\ndescribe \"$.pivotUI()\", ->\n    describe \"with no rows/cols, default count aggregator, subtotal renderer\",  ->\n        table = null\n\n        beforeEach (done) ->\n            table = $(\"<div>\").pivotUI fixtureData, {\n                dataClass: $.pivotUtilities.SubtotalPivotData,\n                renderers: $.pivotUtilities.subtotal_renderers,\n                onRefresh: done\n            }\n\n\n        it \"has all the basic UI elements\", (done) ->\n            expect table.find(\"td.pvtAxisContainer\").length\n            .toBe   3\n            expect table.find(\"td.pvtRendererArea\").length\n            .toBe   1\n            expect table.find(\"td.pvtVals\").length\n            .toBe   1\n            expect table.find(\"select.pvtRenderer\").length\n            .toBe   1\n            expect table.find(\"select.pvtAggregator\").length\n            .toBe   1\n            expect table.find(\"span.pvtAttr\").length\n            .toBe   6\n            expect table.find(\"th.pvtTotalLabel\").length\n            .toBe   1 \n            expect table.find(\"td.pvtGrandTotal\").length\n            .toBe   1 \n            done()\n\n        it \"reflects its inputs\", (done) ->\n            expect table.find(\"td.pvtUnused span.pvtAttr\").length\n            .toBe  6\n            expect table.find(\"select.pvtRenderer\").val()\n            .toBe  \"Table With Subtotal\"\n            expect table.find(\"select.pvtAggregator\").val()\n            .toBe  \"Count\"\n            done()\n\n        it \"renders a table\", (done) ->\n            expect table.find(\"table.pvtTable\").length\n            .toBe  1 \n            done()\n\n        describe \"its renderer output\", ->\n            it \"has the correct type and number of cells\", (done) ->\n                expect table.find(\"th.pvtTotalLabel\").length\n                .toBe  1 \n                expect table.find(\"td.pvtGrandTotal\").length\n                .toBe  1 \n                done()\n\n            it \"has the correct textual representation\", (done) ->\n                expect table.find(\"table.pvtTable\").text()\n                .toBe [\"Totals\", \"14\"].join(\"\")\n                done()\n\n            it \"has a correct grand total with data value\", (done) ->\n                expect table.find(\"td.pvtGrandTotal\").text()\n                .toBe  \"14\"\n                expect table.find(\"td.pvtGrandTotal\").data(\"value\")\n                .toBe  14\n                done()\n\n    describe \"with collapsed rows and cols, subtotal_aggregators\",  ->\n        table = null\n\n        beforeEach (done) ->\n            table = $(\"<div>\").pivotUI fixtureData, \n                dataClass: $.pivotUtilities.SubtotalPivotData,\n                rows: [\"gender\", \"colour\"],\n                cols: [\"birthday\", \"trials\"],\n                aggregators: $.pivotUtilities.subtotal_aggregators,\n                vals: [\"successes\"],\n                renderers: $.pivotUtilities.subtotal_renderers,\n                rendererOptions: {\n                    collapseColsAt: 0,\n                    collapseRowsAt: 0\n                },\n                onRefresh: done\n\n        it \"has all the basic UI elements\", (done) ->\n            expect table.find(\"td.pvtAxisContainer\").length\n            .toBe  3\n            expect table.find(\"td.pvtRendererArea\").length\n            .toBe  1\n            expect table.find(\"td.pvtVals\").length\n            .toBe  1\n            expect table.find(\"select.pvtRenderer\").length\n            .toBe  1\n            expect table.find(\"select.pvtAggregator\").length\n            .toBe  1\n            expect table.find(\"span.pvtAttr\").length\n            .toBe  6\n            done()\n\n        it \"reflects its inputs\", (done) ->\n            expect table.find(\"td.pvtUnused span.pvtAttr\").length\n            .toBe  2 \n            expect table.find(\"td.pvtRows span.pvtAttr\").length\n            .toBe  2 \n            expect table.find(\"td.pvtCols span.pvtAttr\").length\n            .toBe  2 \n            expect table.find(\"select.pvtRenderer\").val()\n            .toBe  \"Table With Subtotal\"\n            expect table.find(\"select.pvtAggregator\").val()\n            .toBe  \"Sum As Fraction Of Parent Row\"\n            done()\n\n        it \"renders a table\", (done) ->\n            expect table.find(\"table.pvtTable\").length\n            .toBe  1 \n            done()\n\n        describe \"its renderer output\", ->\n            it \"has the correct type and number of cells\", (done) ->\n                expect table.find(\"th.pvtAxisLabel\").length\n                .toBe  4 \n                expect table.find(\"th.pvtAxisLabel.collapsed\").length\n                .toBe  4 \n                expect table.find(\"th.pvtRowLabel.rowcollapsed\").length\n                .toBe  2\n                expect table.find(\"th.pvtColLabel.colcollapsed\").length\n                .toBe  10 \n                expect table.find(\"th.pvtTotalLabel.rowTotal\").length\n                .toBe  1 \n                expect table.find(\"th.pvtTotalLabel.colTotal\").length\n                .toBe  1 \n                expect table.find(\"td.pvtVal.pvtColSubtotal.pvtRowSubtotal\").length\n                .toBe  20 \n                expect table.find(\"td.pvtTotal.rowTotal.pvtRowSubtotal\").length\n                .toBe  2 \n                expect table.find(\"td.pvtTotal.colTotal.pvtColSubtotal\").length\n                .toBe  10 \n                expect table.find(\"td.pvtGrandTotal\").length\n                .toBe  1 \n                done()\n\n            it \"has the correct textual representation\", (done) ->\n                expect table.find(\"th.pvtColLabel\").text()\n                .toBe \" \\u25B6 1982-11-05 \\u25B6 1982-11-07 \\u25B6 1982-11-08 \\u25B6 1982-12-01 \\u25B6 1982-12-03 \\u25B6 1982-12-06 \\u25B6 1982-12-07 \\u25B6 1982-12-08 \\u25B6 1982-12-09 \\u25B6 1983-11-1111210311295112112112112112112112102\"\n                expect table.find(\"th.pvtRowLabel\").text()\n                .toBe \" \\u25B6 femaleblueredyellow \\u25B6 maleblueredyellow\"\n                done()\n\n            it \"has a correct spot-checked cell with data value\", (done) ->\n                expect table.find(\"td.pvtVal.pvtRowSubtotal.row0.col3.rowcol0.colcol1\").text()\n                .toBe  \"17.9%\"\n                expect table.find(\"td.pvtVal.pvtTotal.colTotal.pvtColSubtotal.col3.colcol0\").data(\"value\")\n                .toBe  (50+30)/280\n                done()\n\n    describe \"with row and col subtotal hidden on expand\",  ->\n        table = null\n\n        beforeEach (done) ->\n            table = $(\"<div>\").pivotUI fixtureData, \n                dataClass: $.pivotUtilities.SubtotalPivotData,\n                rows: [\"colour\", \"birthday\", \"name\"],\n                cols: [\"trials\", \"gender\", \"successes\"],\n                aggregators: $.pivotUtilities.subtotal_aggregators,\n                vals: [\"successes\"],\n                renderers: $.pivotUtilities.subtotal_renderers,\n                rendererOptions: {\n                    rowSubtotalDisplay: {\n                        hideOnExpand: true\n                    },\n                    colSubtotalDisplay: {\n                        hideOnExpand: true\n                    }\n                },\n                onRefresh: done\n\n        it \"has all the basic UI elements\", (done) ->\n            expect table.find(\"td.pvtAxisContainer\").length\n            .toBe  3\n            expect table.find(\"td.pvtRendererArea\").length\n            .toBe  1\n            expect table.find(\"td.pvtVals\").length\n            .toBe  1\n            expect table.find(\"select.pvtRenderer\").length\n            .toBe  1\n            expect table.find(\"select.pvtAggregator\").length\n            .toBe  1\n            expect table.find(\"span.pvtAttr\").length\n            .toBe  6\n            done()\n\n        it \"reflects its inputs\", (done) ->\n            expect table.find(\"td.pvtUnused span.pvtAttr\").length\n            .toBe  0 \n            expect table.find(\"td.pvtRows span.pvtAttr\").length\n            .toBe  3 \n            expect table.find(\"td.pvtCols span.pvtAttr\").length\n            .toBe  3 \n            expect table.find(\"select.pvtRenderer\").val()\n            .toBe  \"Table With Subtotal\"\n            expect table.find(\"select.pvtAggregator\").val()\n            .toBe  \"Sum As Fraction Of Parent Row\"\n            done()\n\n        it \"renders a table\", (done) ->\n            expect table.find(\"table.pvtTable\").length\n            .toBe  1 \n            done()\n\n        describe \"its renderer output\", ->\n            it \"has the correct type and number of cells\", (done) ->\n                expect table.find(\"th.pvtAxisLabel\").length\n                .toBe  6\n                expect table.find(\"th.pvtAxisLabel.collapsed\").length\n                .toBe  0\n                expect table.find(\"th.pvtRowLabel.rowshow.rowcollapsed\").length\n                .toBe  0\n                expect table.find(\"th.pvtColLabel.colshow.colcollapsed\").length\n                .toBe  0\n                expect table.find(\"th.pvtRowLabel.rowshow.rowexpanded\").length\n                .toBe  28\n                expect table.find(\"th.pvtColLabel.colshow.colexpanded\").length\n                .toBe  17\n                expect table.find(\"th.pvtRowLabelFiller.rowhide.rowexpanded\").length\n                .toBe  14\n                expect table.find(\"th.pvtColLabelFiller.colhide.colexpanded\").length\n                .toBe  9 \n                expect table.find(\"td.pvtColSubtotal.pvtRowSubtotal.colhide.colexpanded.rowhide.rowexpanded\").length\n                .toBe  9*14 \n                expect table.find(\"th.pvtTotalLabel.rowTotal\").length\n                .toBe  1 \n                expect table.find(\"th.pvtTotalLabel.colTotal\").length\n                .toBe  1 \n                expect table.find(\"td.pvtTotal.rowTotal.pvtRowSubtotal\").length\n                .toBe  14 \n                expect table.find(\"td.pvtTotal.colTotal.pvtColSubtotal\").length\n                .toBe  9\n                expect table.find(\"td.pvtGrandTotal\").length\n                .toBe  1 \n                done()\n\n            it \"has the correct textual representation\", (done) ->\n                expect table.find(\"th.pvtColLabel\").text()\n                .toBe \" \\u25E2 95 \\u25E2 102 \\u25E2 103 \\u25E2 112 \\u25E2 female \\u25E2 female \\u25E2 male \\u25E2 female \\u25E2 male2514121412142530\"\n                expect table.find(\"th.pvtRowLabel\").text()\n                .toBe \" \\u25E2 blue \\u25E2 1982-11-07NickRaj \\u25E2 1982-12-03Geeth \\u25E2 1982-12-07Nila \\u25E2 1982-12-08John \\u25E2 1982-12-09Joshi \\u25E2 red \\u25E2 1982-11-05Malar \\u25E2 1982-11-08JaneRaniSai \\u25E2 yellow \\u25E2 1982-11-07Mukhi \\u25E2 1982-12-01Vel \\u25E2 1982-12-06Yaazhi \\u25E2 1983-11-11Carol\"\n                done()\n\n            it \"has a correct spot-checked cell with data value\", (done) ->\n                expect table.find(\"td.pvtVal.rowshow.colshow.row10.col5.rowcol2.colcol2\").text()\n                .toBe  \"100.0%\"\n                expect table.find(\"td.pvtVal[data-rownode=\\\"1\\\"][data-colnode=\\\"6\\\"]\").text()\n                .toBe  \"50.0%\"\n                done()\n\n    describe \"with row subtotal displayed at bottom\",  ->\n        table = null\n\n        beforeEach (done) ->\n            table = $(\"<div>\").pivotUI fixtureData, \n                dataClass: $.pivotUtilities.SubtotalPivotData,\n                rows: [\"colour\", \"birthday\"],\n                cols: [\"gender\", \"successes\"]\n                vals: [\"successes\"],\n                renderers: $.pivotUtilities.subtotal_renderers,\n                rendererOptions: {\n                    rowSubtotalDisplay: {\n                        displayOnTop: false\n                    }\n                },\n                onRefresh: done\n\n        it \"has all the basic UI elements\", (done) ->\n            expect table.find(\"td.pvtAxisContainer\").length\n            .toBe  3\n            expect table.find(\"td.pvtRendererArea\").length\n            .toBe  1\n            expect table.find(\"td.pvtVals\").length\n            .toBe  1\n            expect table.find(\"select.pvtRenderer\").length\n            .toBe  1\n            expect table.find(\"select.pvtAggregator\").length\n            .toBe  1\n            expect table.find(\"span.pvtAttr\").length\n            .toBe  6\n            done()\n\n        it \"reflects its inputs\", (done) ->\n            expect table.find(\"td.pvtUnused span.pvtAttr\").length\n            .toBe  2 \n            expect table.find(\"td.pvtRows span.pvtAttr\").length\n            .toBe  2 \n            expect table.find(\"td.pvtCols span.pvtAttr\").length\n            .toBe  2 \n            expect table.find(\"select.pvtRenderer\").val()\n            .toBe  \"Table With Subtotal\"\n            done()\n\n        it \"renders a table\", (done) ->\n            expect table.find(\"table.pvtTable\").length\n            .toBe  1 \n            done()\n\n        describe \"its renderer output\", ->\n            it \"has the correct type and number of cells\", (done) ->\n                expect table.find(\".pvtTable tbody tr:first-child th\").length\n                .toBe  1\n                expect table.find(\".pvtTable tbody tr:first-child th\").attr(\"rowspan\")\n                .toBe  \"7\"\n                expect table.find(\"tr:nth-child(7) th.pvtRowLabelFiller\").length\n                .toBe  1\n                expect table.find(\"th.pvtTotalLabel.rowTotal\").length\n                .toBe  1 \n                expect table.find(\"th.pvtTotalLabel.colTotal\").length\n                .toBe  1 \n                expect table.find(\"td.pvtTotal.rowTotal.pvtRowSubtotal\").length\n                .toBe  3 \n                expect table.find(\"td.pvtTotal.colTotal.pvtColSubtotal\").length\n                .toBe  2\n                expect table.find(\"td.pvtGrandTotal\").length\n                .toBe  1 \n                done()\n\n            it \"has the correct textual representation\", (done) ->\n                expect table.find(\"th.pvtColLabel\").text()\n                .toBe \" \\u25E2 female \\u25E2 male142512142530\"\n                expect table.find(\"th.pvtRowLabel\").text()\n                .toBe \" \\u25E2 blue1982-11-071982-12-031982-12-071982-12-081982-12-09 \\u25E2 red1982-11-051982-11-08 \\u25E2 yellow1982-11-071982-12-011982-12-061983-11-11\"\n                done()\n\n            it \"has a correct spot-checked cell with data value\", (done) ->\n                expect table.find(\"tr:nth-child(7) td.pvtTotal\").text()\n                .toBe  \"6\"\n                expect table.find(\"td.pvtVal.row5.rowcol0.pvtRowSubtotal.col0.colcol0.pvtColSubtotal\").text()\n                .toBe  \"2\"\n                expect table.find(\"td.pvtVal[data-rownode=\\\"13\\\"][data-colnode=\\\"7\\\"]\").text()\n                .toBe  \"3\"\n                done()\n\ndescribe \"$.pivot()\", ->\n    describe \"with no rows/cols, default count aggregator, subtotal renderer\",  ->\n        table = $(\"<div>\").pivot fixtureData, {\n            dataClass: $.pivotUtilities.SubtotalPivotData,\n            renderer: $.pivotUtilities.subtotal_renderers[\"Table With Subtotal\"]\n        }\n\n        it \"has all the basic UI elements\", ->\n            expect table.find(\"th.pvtTotalLabel\").length\n            .toBe   1 \n            expect table.find(\"td.pvtGrandTotal\").length\n            .toBe   1 \n\n        it \"renders a table\", ->\n            expect table.find(\"table.pvtTable\").length\n            .toBe  1 \n\n        describe \"its renderer output\", ->\n            it \"has the correct type and number of cells\", ->\n                expect table.find(\"th.pvtTotalLabel\").length\n                .toBe  1 \n                expect table.find(\"td.pvtGrandTotal\").length\n                .toBe  1 \n\n            it \"has the correct textual representation\", ->\n                expect table.find(\"table.pvtTable\").text()\n                .toBe [\"Totals\", \"14\"].join(\"\")\n\n            it \"has a correct grand total with data value\", ->\n                expect table.find(\"td.pvtGrandTotal\").text()\n                .toBe  \"14\"\n                expect table.find(\"td.pvtGrandTotal\").data(\"value\")\n                .toBe  14\n\n    describe \"with rows/cols, subtotal_aggregator\",  ->\n        table = $(\"<div>\").pivot fixtureData, \n            dataClass: $.pivotUtilities.SubtotalPivotData,\n            rows: [\"gender\", \"colour\"],\n            cols: [\"birthday\", \"trials\"],\n            aggregator: $.pivotUtilities.subtotal_aggregators[\"Sum As Fraction Of Parent Column\"]([\"successes\"]),\n            renderer: $.pivotUtilities.subtotal_renderers[\"Table With Subtotal\"]\n\n        it \"renders a table\", ->\n            expect table.find(\"table.pvtTable\").length\n            .toBe  1 \n\n        describe \"its renderer output\", ->\n            it \"has the correct type and number of cells\", ->\n                expect table.find(\"th.pvtAxisLabel\").length\n                .toBe  4 \n                expect table.find(\"th.collapsed\").length\n                .toBe  0 \n                expect table.find(\"th.expanded, th.rowexpanded, th.colexpanded\").length\n                .toBe  4+(2*5)+(10*2)+12 \n                expect table.find(\"th.pvtAxisLabel.expanded\").length\n                .toBe  4\n                expect table.find(\"th.pvtRowLabel.rowexpanded\").length\n                .toBe  8\n                expect table.find(\"th.pvtColLabel.colexpanded\").length\n                .toBe  22 \n                expect table.find(\"th.pvtTotalLabel.rowTotal\").length\n                .toBe  1 \n                expect table.find(\"th.pvtTotalLabel.colTotal\").length\n                .toBe  1 \n                expect table.find(\"td.pvtVal.pvtColSubtotal.pvtRowSubtotal\").length\n                .toBe  20 \n                expect table.find(\"td.pvtTotal.rowTotal.pvtRowSubtotal\").length\n                .toBe  2 \n                expect table.find(\"td.pvtTotal.colTotal.pvtColSubtotal\").length\n                .toBe  10 \n                expect table.find(\"td.pvtGrandTotal\").length\n                .toBe  1 \n\n            it \"has the correct textual representation\", ->\n                expect table.find(\"th.pvtColLabel\").text()\n                .toBe \" \\u25E2 1982-11-05 \\u25E2 1982-11-07 \\u25E2 1982-11-08 \\u25E2 1982-12-01 \\u25E2 1982-12-03 \\u25E2 1982-12-06 \\u25E2 1982-12-07 \\u25E2 1982-12-08 \\u25E2 1982-12-09 \\u25E2 1983-11-1111210311295112112112112112112112102\"\n                expect table.find(\"th.pvtRowLabel\").text()\n                .toBe \" \\u25E2 femaleblueredyellow \\u25E2 maleblueredyellow\"\n\n            it \"has a correct spot-checked cell with data value\", ->\n                expect table.find(\"td.pvtVal.pvtTotal.colTotal.col3.colcol1\").text()\n                .toBe  \"62.5%\"\n                expect table.find(\"td.pvtVal.pvtTotal.colTotal.col4.colcol1\").data(\"value\")\n                .toBe  30/80\n\ndescribe \"$.pivotUtilities\", ->\n\n    describe \".SubtotalPivotData()\", ->\n        sumOverSumOpts = \n            rows: [], cols: []\n            aggregator: $.pivotUtilities.aggregators[\"Sum over Sum\"]([\"a\",\"b\"])\n            filter: -> true\n            sorters: ->\n\n        describe \"with array-of-array input\", ->\n            aoaInput =  [ [\"a\",\"b\"], [1,2], [3,4] ]\n            pd = new $.pivotUtilities.SubtotalPivotData aoaInput, sumOverSumOpts\n\n            it \"has the correct grand total value\", ->\n                expect pd.getAggregator([],[]).value()\n                .toBe (1+3)/(2+4)\n\n        describe \"with array-of-object input\", ->\n            aosInput =  [ {a:1, b:2}, {a:3, b:4} ]\n            pd = new $.pivotUtilities.SubtotalPivotData aosInput, sumOverSumOpts\n\n            it \"has the correct grand total value\", ->\n                expect pd.getAggregator([],[]).value()\n                .toBe (1+3)/(2+4)\n\n        describe \"with function input\", ->\n            functionInput = (record) ->\n                record a:1, b:2\n                record a:3, b:4\n            pd = new $.pivotUtilities.SubtotalPivotData functionInput, sumOverSumOpts\n\n            it \"has the correct grand total value\", ->\n                expect pd.getAggregator([],[]).value()\n                .toBe (1+3)/(2+4)\n\n        describe \"with jQuery table element input\", ->\n            tableInput = $ \"\"\"\n                <table>\n                    <thead> \n                        <tr> <th>a</th><th>b</th> </tr>\n                    </thead> \n                    <tbody>\n                        <tr> <td>1</td> <td>2</td> </tr>\n                        <tr> <td>3</td> <td>4</td> </tr>\n                    </tbody>\n                </table>\n                \"\"\"\n\n            pd = new $.pivotUtilities.SubtotalPivotData tableInput, sumOverSumOpts\n\n            it \"has the correct grand total value\", ->\n                expect pd.getAggregator([],[]).value()\n                .toBe (1+3)/(2+4)\n\n\n        describe \"with rows/cols, no filters/sorters, count aggregator\", ->\n            pd = new $.pivotUtilities.SubtotalPivotData fixtureData2, \n                rows: [\"name\", \"colour\"], \n                cols: [\"trials\", \"successes\"],\n                aggregator: $.pivotUtilities.aggregators[\"Count\"](),\n                filter: -> true\n                sorters: ->\n\n            it \"has correctly-ordered row keys\", ->\n                expect pd.getRowKeys()\n                .toEqual [ [ 'Carol', 'yellow' ], [ 'Jane', 'red' ], [ 'John', 'blue' ], [ 'Nick', 'blue' ] ]\n               \n            it \"has correctly-ordered col keys\", ->\n                expect pd.getColKeys()\n                .toEqual [ [ 95, 25 ], [ 102, 14 ], [ 103, 12 ], [ 112, 30 ] ]\n\n            it \"can be iterated over\", ->\n                numNotNull = 0\n                numNull = 0\n                for r in pd.getRowKeys()\n                    for c in pd.getColKeys()\n                        if pd.getAggregator(r, c).value()?\n                            numNotNull++ \n                        else\n                            numNull++\n                expect numNotNull\n                .toBe 4\n                expect numNull\n                .toBe 12\n\n            it \"has a correct spot-checked aggregator\", ->\n                spots = [ {spot: [['Carol', 'yellow'], [102, 14]], val: 1}, {spot:  [['Jane', 'red'], [95, 25]], val: 1}, {spot: [['John', 'blue'], [112, 30]], val: 1}, {spot: [['Nick', 'blue'], [103, 12]], val: 1} ]\n                for s in spots\n                    agg = pd.getAggregator(s.spot[0],s.spot[1])\n                    val = agg.value()\n                    expect(val).toBe 1 \n                    expect(agg.format(val)).toBe \"\" + s.val\n\n            it \"has correct spot-checked aggregators for subtotal-rows and subtotal-columns\", ->\n                spots = [ {spot: [['Carol'], [102]], val: 1}, {spot:  [['Jane'], [95]], val: 1}, {spot: [['John'], [112]], val: 1}, {spot: [['Nick'], [103]], val: 1} ]\n                for s in spots\n                    agg = pd.getAggregator(s.spot[0], s.spot[1])\n                    val = agg.value()\n                    expect(val).toBe s.val \n                    expect(agg.format(val)).toBe \"\" + s.val\n\n            it \"has correct row-total for subtotal-rows\", ->\n                for hdr in ['Carol', 'Jane', 'John', 'Nick']\n                    agg = pd.getAggregator([hdr],[])\n                    val = agg.value()\n                    expect(val).toBe 1\n                    expect(agg.format(val)).toBe \"1\"\n\n            it \"has correct column-total for subtotal-columns\", ->\n                for hdr in [95, 102, 103, 112]\n                    agg = pd.getAggregator([],[hdr])\n                    val = agg.value()\n                    expect(val).toBe 1\n                    expect(agg.format(val)).toBe \"1\"\n\n            it \"has a correct grand total aggregator\", ->\n                agg = pd.getAggregator([],[])\n                val = agg.value()\n                expect(val).toBe 4 \n                expect(agg.format(val)).toBe \"4\"\n"]}